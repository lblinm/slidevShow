import{d as b,y as M,t as q,D as H,n as T,ac as B,o as m,b as p,i as d,e as L,x as D}from"../modules/vue-BixPK0c7.js";import{C as A,_ as $}from"../index-BZfUZceQ.js";const I=["innerHTML"],P=["textContent"],V=["textContent"],k="slidev-note-fade",r="slidev-note-click-mark",K=b({__name:"NoteDisplay",props:{class:{type:[String,Array],required:!1},noteHtml:{type:String,required:!1},note:{type:String,required:!1},placeholder:{type:String,required:!1},clicksContext:{type:null,required:!1},autoScroll:{type:Boolean,required:!1}},emits:["markerDblclick","markerClick"],setup(N,{emit:w}){const n=N,v=w,y=M(()=>{var o;return n.clicksContext!=null&&((o=n.noteHtml)==null?void 0:o.includes("slidev-note-click-mark"))}),a=q(null);function g(){var S;if(!a.value||!y.value)return;const o=Array.from(a.value.querySelectorAll(`.${r}`)),l=+(((S=n.clicksContext)==null?void 0:S.current)??A),c=l<0||l>=A,h=new Set;function C(e){!e||e===a.value||(h.add(e),e.parentElement&&C(e.parentElement))}const _=new Map;for(const e of o){const t=e.parentElement,s=Number(e.dataset.clicks);_.set(s,e),C(t),Array.from(t.childNodes).forEach(f=>{if(f.nodeType===3){const x=document.createElement("span");x.textContent=f.textContent,t.insertBefore(x,f),f.remove()}})}const E=Array.from(a.value.querySelectorAll("*"));let i=0;const u=new Map;for(const e of E)u.has(i)||u.set(i,[]),u.get(i).push(e),e.classList.contains(r)&&(i=Number(e.dataset.clicks)||i+1);for(const[e,t]of u)c?t.forEach(s=>s.classList.remove(k)):t.forEach(s=>s.classList.toggle(k,h.has(s)?!1:e!==l));for(const[e,t]of _)t.classList.remove(k),t.classList.toggle(`${r}-past`,c?!1:e<l),t.classList.toggle(`${r}-active`,c?!1:e===l),t.classList.toggle(`${r}-next`,c?!1:e===l+1),t.classList.toggle(`${r}-future`,c?!1:e>l+1),t.ondblclick=s=>{v("markerDblclick",s,e),!s.defaultPrevented&&(n.clicksContext.current=e,s.stopPropagation(),s.stopImmediatePropagation())},t.onclick=s=>{v("markerClick",s,e)},n.autoScroll&&e===l&&t.scrollIntoView({block:"center",behavior:"smooth"})}return H(()=>{var o;return[n.noteHtml,(o=n.clicksContext)==null?void 0:o.current]},()=>{T(()=>{g()})},{immediate:!0}),B(()=>{g()}),(o,l)=>o.noteHtml?(m(),p("div",{key:0,ref_key:"noteDisplay",ref:a,class:d(["prose overflow-auto outline-none slidev-note",[n.class,y.value?"slidev-note-with-clicks":""]]),innerHTML:o.noteHtml},null,10,I)):o.note?(m(),p("div",{key:1,class:d(["prose overflow-auto outline-none slidev-note",n.class])},[L("p",{textContent:D(o.note)},null,8,P)],2)):(m(),p("div",{key:2,class:d(["prose overflow-auto outline-none opacity-50 italic select-none slidev-note",n.class])},[L("p",{textContent:D(n.placeholder||"No notes.")},null,8,V)],2))}}),F=$(K,[["__file","D:/DevTools/NVM/nvm/v18.17.0/node_modules/@slidev/cli/node_modules/@slidev/client/internals/NoteDisplay.vue"]]);export{F as N};
